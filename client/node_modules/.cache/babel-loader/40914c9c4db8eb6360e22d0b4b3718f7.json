{"ast":null,"code":"import _classCallCheck from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/jasonw/Desktop/React/bugtracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{Link}from'react-router-dom';import axios from'axios';import\"../bugtrack/bugs.css\";import jwt_decode from\"jwt-decode\";import setAuthToken from\"../../utils/setAuthToken\";import{setCurrentUser,logoutUser}from\"../../actions/authActions\";import store from\"../../store\";if(localStorage.jwtToken){// Set auth token header auth\nvar token=localStorage.jwtToken;setAuthToken(token);// Decode token and get user info and exp\nvar decoded=jwt_decode(token);// Set user and isAuthenticated\nstore.dispatch(setCurrentUser(decoded));// Check for expired token\nvar currentTime=Date.now()/1000;// to get in milliseconds\nif(decoded.exp<currentTime){// Logout user\nstore.dispatch(logoutUser());// Redirect to login\nwindow.location.href=\"/login\";}}var Bug=function Bug(props){return React.createElement(\"tr\",null,props.projectName,React.createElement(\"td\",{className:props.bug.completed?'completed':''},props.bug.description),React.createElement(\"td\",{className:props.bug.completed?'completed':''},new Intl.DateTimeFormat(\"en-GB\",{year:\"numeric\",month:\"long\",day:\"2-digit\"}).format(new Date(props.date))),React.createElement(\"td\",{className:props.bug.completed?'completed':''},props.bug.members),React.createElement(\"td\",{className:props.bug.completed?'completed':''},props.bug.priority),React.createElement(\"td\",null,React.createElement(Link,{to:\"/edit/\"+props.bug._id,className:\"btn btn-success\"},\"Edit \"),\" \",React.createElement(\"button\",{className:\"btn btn-danger\",onClick:function onClick(){props.deleteBug(props.bug._id);}},\" Delete\")));};var BugList=/*#__PURE__*/function(_Component){_inherits(BugList,_Component);function BugList(props){var _this;_classCallCheck(this,BugList);_this=_possibleConstructorReturn(this,_getPrototypeOf(BugList).call(this,props));_this.state={bugs:[],query:'',projects:[]};_this.searchQuery=_this.searchQuery.bind(_assertThisInitialized(_this));_this.deleteBug=_this.deleteBug.bind(_assertThisInitialized(_this));return _this;}_createClass(BugList,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axios.get('http://localhost:4000/bugs/').then(function(response){_this2.setState({bugs:response.data});}).then(axios.get('http://localhost:4000/projects').then(function(response){_this2.setState({projects:response.data});console.log(\"Projects\",JSON.stringify(_this2.state.projects));})).catch(function(error){console.log(error);});}},{key:\"searchQuery\",value:function searchQuery(e){this.setState({query:e.target.value});}},{key:\"deleteBug\",value:function deleteBug(id){axios.delete('http://localhost:4000/bugs/'+id).then(function(response){console.log(response.data);});this.setState({bugs:this.state.bugs.filter(function(el){return el._id!==id;})});}// bugList() {\n//     return this.state.bugs.map((currentBug) =>{\n//         return <Bug bug={currentBug}\n//                     deleteBug={this.deleteBug}\n//                     key={currentBug._id}\n//                     date={currentBug.date.substring(0,10)} />;\n//     });\n// }\n},{key:\"render\",value:function render(){var _this3=this;console.log(\"Bugs projects \",this.state.projects);console.log(\"Bugs component \"+JSON.stringify(this.state.bugs));var findQuery=this.state.bugs.filter(function(i){return i.description.toLowerCase().indexOf(_this3.state.query.toLowerCase())!==-1;});var newArr=[];var getProjectName=this.state.projects.filter(function(i){_this3.state.bugs.filter(function(j){if(i._id===j.projects){return React.createElement(\"td\",null,i.projectName);}});});console.log(\"New arr\",newArr);console.log(\"GetProject Name\",getProjectName);console.log(\"Query: \"+this.state.query);console.log(\"Date: \",this.state.projects.dateCreated);//console.log(\"Found query \" + JSON.stringify(findQuery));\nreturn React.createElement(\"div\",{className:\"container-fluid\"},React.createElement(\"ol\",{className:\"breadcrumb mb-3\"},React.createElement(\"li\",{className:\"breadcrumb-item active\"},React.createElement(\"strong\",null,\"Bugs list\"))),React.createElement(\"input\",{className:\"form-control mr-sm-2\",onChange:this.searchQuery,type:\"text\",placeholder:\"Search descriptions...\"}),React.createElement(\"table\",{className:\"table\"},React.createElement(\"thead\",null,React.createElement(\"tr\",null,React.createElement(\"th\",null,\"Description\"),React.createElement(\"th\",null,\"Deadline\"),React.createElement(\"th\",null,\"Assignee\"),React.createElement(\"th\",null,\"Priority\"),React.createElement(\"th\",null,\"Actions\"))),React.createElement(\"tbody\",null,findQuery.map(function(currentBug){return React.createElement(Bug,{bug:currentBug,deleteBug:_this3.deleteBug,key:currentBug._id,date:currentBug.date,projectName:getProjectName});}))));}}]);return BugList;}(Component);// \nexport{BugList as default};","map":{"version":3,"sources":["/home/jasonw/Desktop/React/bugtracker/client/src/components/bugtrack/buglist.component.js"],"names":["React","Component","Link","axios","jwt_decode","setAuthToken","setCurrentUser","logoutUser","store","localStorage","jwtToken","token","decoded","dispatch","currentTime","Date","now","exp","window","location","href","Bug","props","projectName","bug","completed","description","Intl","DateTimeFormat","year","month","day","format","date","members","priority","_id","deleteBug","BugList","state","bugs","query","projects","searchQuery","bind","get","then","response","setState","data","console","log","JSON","stringify","catch","error","e","target","value","id","delete","filter","el","findQuery","i","toLowerCase","indexOf","newArr","getProjectName","j","dateCreated","map","currentBug"],"mappings":"g/BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,sBAAP,CACA,MAAOC,CAAAA,UAAP,KAAuB,YAAvB,CACA,MAAOC,CAAAA,YAAP,KAAyB,0BAAzB,CACA,OAASC,cAAT,CAAyBC,UAAzB,KAA2C,2BAA3C,CACA,MAAOC,CAAAA,KAAP,KAAkB,aAAlB,CAEA,GAAIC,YAAY,CAACC,QAAjB,CAA2B,CACvB;AACA,GAAMC,CAAAA,KAAK,CAAGF,YAAY,CAACC,QAA3B,CACAL,YAAY,CAACM,KAAD,CAAZ,CACA;AACA,GAAMC,CAAAA,OAAO,CAAGR,UAAU,CAACO,KAAD,CAA1B,CACA;AACAH,KAAK,CAACK,QAAN,CAAeP,cAAc,CAACM,OAAD,CAA7B,EACF;AACE,GAAME,CAAAA,WAAW,CAAGC,IAAI,CAACC,GAAL,GAAa,IAAjC,CAAuC;AACvC,GAAIJ,OAAO,CAACK,GAAR,CAAcH,WAAlB,CAA+B,CAC7B;AACAN,KAAK,CAACK,QAAN,CAAeN,UAAU,EAAzB,EACA;AACAW,MAAM,CAACC,QAAP,CAAgBC,IAAhB,CAAuB,QAAvB,CACD,CACF,CAEH,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,CAAAC,KAAK,QAEb,+BAEKA,KAAK,CAACC,WAFX,CAGI,0BAAI,SAAS,CAAED,KAAK,CAACE,GAAN,CAAUC,SAAV,CAAsB,WAAtB,CAAoC,EAAnD,EAAwDH,KAAK,CAACE,GAAN,CAAUE,WAAlE,CAHJ,CAII,0BAAI,SAAS,CAAEJ,KAAK,CAACE,GAAN,CAAUC,SAAV,CAAsB,WAAtB,CAAoC,EAAnD,EACK,GAAIE,CAAAA,IAAI,CAACC,cAAT,CAAwB,OAAxB,CAAiC,CAC9BC,IAAI,CAAE,SADwB,CAE9BC,KAAK,CAAE,MAFuB,CAG9BC,GAAG,CAAE,SAHyB,CAAjC,EAIEC,MAJF,CAIS,GAAIjB,CAAAA,IAAJ,CAASO,KAAK,CAACW,IAAf,CAJT,CADL,CAJJ,CAWI,0BAAI,SAAS,CAAEX,KAAK,CAACE,GAAN,CAAUC,SAAV,CAAsB,WAAtB,CAAoC,EAAnD,EAAwDH,KAAK,CAACE,GAAN,CAAUU,OAAlE,CAXJ,CAYI,0BAAI,SAAS,CAAEZ,KAAK,CAACE,GAAN,CAAUC,SAAV,CAAsB,WAAtB,CAAoC,EAAnD,EAAwDH,KAAK,CAACE,GAAN,CAAUW,QAAlE,CAZJ,CAcI,8BACI,oBAAC,IAAD,EAAM,EAAE,CAAE,SAASb,KAAK,CAACE,GAAN,CAAUY,GAA7B,CAAkC,SAAS,CAAC,iBAA5C,UADJ,KACgF,8BAAQ,SAAS,CAAC,gBAAlB,CAAmC,OAAO,CAAE,kBAAM,CAAEd,KAAK,CAACe,SAAN,CAAgBf,KAAK,CAACE,GAAN,CAAUY,GAA1B,EAAgC,CAApF,YADhF,CAdJ,CAFa,EAAjB,C,GAqBqBE,CAAAA,O,iEACjB,iBAAYhB,KAAZ,CAAmB,yCACf,yEAAMA,KAAN,GAEA,MAAKiB,KAAL,CAAa,CACTC,IAAI,CAAE,EADG,CAETC,KAAK,CAAE,EAFE,CAGTC,QAAQ,CAAE,EAHD,CAAb,CAKA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBC,IAAjB,+BAAnB,CACA,MAAKP,SAAL,CAAiB,MAAKA,SAAL,CAAeO,IAAf,+BAAjB,CATe,aAWlB,C,iFAGmB,iBAChBzC,KAAK,CAAC0C,GAAN,CAAU,6BAAV,EACKC,IADL,CACU,SAAAC,QAAQ,CAAI,CACd,MAAI,CAACC,QAAL,CAAc,CACVR,IAAI,CAAEO,QAAQ,CAACE,IADL,CAAd,EAGH,CALL,EAKOH,IALP,CAKY3C,KAAK,CAAC0C,GAAN,CAAU,gCAAV,EACHC,IADG,CACE,SAAAC,QAAQ,CAAI,CACd,MAAI,CAACC,QAAL,CAAc,CACVN,QAAQ,CAAEK,QAAQ,CAACE,IADT,CAAd,EAEAC,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBC,IAAI,CAACC,SAAL,CAAe,MAAI,CAACd,KAAL,CAAWG,QAA1B,CAAxB,EACH,CALG,CALZ,EAWKY,KAXL,CAWW,SAASC,KAAT,CAAgB,CACnBL,OAAO,CAACC,GAAR,CAAYI,KAAZ,EACH,CAbL,EAcH,C,gDAGWC,C,CAAG,CACX,KAAKR,QAAL,CAAc,CACVP,KAAK,CAAEe,CAAC,CAACC,MAAF,CAASC,KADN,CAAd,EAIH,C,4CAGSC,E,CAAI,CACVxD,KAAK,CAACyD,MAAN,CAAa,8BAA8BD,EAA3C,EACKb,IADL,CACU,SAAAC,QAAQ,CAAI,CAACG,OAAO,CAACC,GAAR,CAAYJ,QAAQ,CAACE,IAArB,EAA2B,CADlD,EAGA,KAAKD,QAAL,CAAc,CACVR,IAAI,CAAE,KAAKD,KAAL,CAAWC,IAAX,CAAgBqB,MAAhB,CAAuB,SAAAC,EAAE,QAAIA,CAAAA,EAAE,CAAC1B,GAAH,GAAWuB,EAAf,EAAzB,CADI,CAAd,EAGH,CAED;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;uCAES,iBACLT,OAAO,CAACC,GAAR,CAAY,gBAAZ,CAA6B,KAAKZ,KAAL,CAAWG,QAAxC,EACAQ,OAAO,CAACC,GAAR,CAAY,kBAAoBC,IAAI,CAACC,SAAL,CAAe,KAAKd,KAAL,CAAWC,IAA1B,CAAhC,EAEA,GAAIuB,CAAAA,SAAS,CAAG,KAAKxB,KAAL,CAAWC,IAAX,CAAgBqB,MAAhB,CACZ,SAAAG,CAAC,QAAIA,CAAAA,CAAC,CAACtC,WAAF,CAAcuC,WAAd,GAA4BC,OAA5B,CAAoC,MAAI,CAAC3B,KAAL,CAAWE,KAAX,CAAiBwB,WAAjB,EAApC,IAAwE,CAAC,CAA7E,EADW,CAAhB,CAIA,GAAIE,CAAAA,MAAM,CAAG,EAAb,CAEA,GAAIC,CAAAA,cAAc,CAAG,KAAK7B,KAAL,CAAWG,QAAX,CAAoBmB,MAApB,CAA2B,SAAAG,CAAC,CAAI,CACjD,MAAI,CAACzB,KAAL,CAAWC,IAAX,CAAgBqB,MAAhB,CAAuB,SAAAQ,CAAC,CAAI,CACxB,GAAGL,CAAC,CAAC5B,GAAF,GAAUiC,CAAC,CAAC3B,QAAf,CAAyB,CACrB,MAAO,+BAAKsB,CAAC,CAACzC,WAAP,CAAP,CACH,CACJ,CAJD,EAKH,CANoB,CAArB,CAQA2B,OAAO,CAACC,GAAR,CAAY,SAAZ,CAAuBgB,MAAvB,EAEAjB,OAAO,CAACC,GAAR,CAAY,iBAAZ,CAA+BiB,cAA/B,EACAlB,OAAO,CAACC,GAAR,CAAY,UAAY,KAAKZ,KAAL,CAAWE,KAAnC,EACAS,OAAO,CAACC,GAAR,CAAY,QAAZ,CAAqB,KAAKZ,KAAL,CAAWG,QAAX,CAAoB4B,WAAzC,EAEA;AAEA,MACI,4BAAK,SAAS,CAAC,iBAAf,EACI,0BAAI,SAAS,CAAC,iBAAd,EACI,0BAAI,SAAS,CAAC,wBAAd,EAAuC,8CAAvC,CADJ,CADJ,CAKI,6BACI,SAAS,CAAC,sBADd,CAEI,QAAQ,CAAE,KAAK3B,WAFnB,CAGI,IAAI,CAAC,MAHT,CAII,WAAW,CAAC,wBAJhB,EALJ,CAYI,6BAAO,SAAS,CAAC,OAAjB,EACQ,iCACI,8BAEI,4CAFJ,CAGI,yCAHJ,CAII,yCAJJ,CAKI,yCALJ,CAMI,wCANJ,CADJ,CADR,CAWQ,iCACHoB,SAAS,CAACQ,GAAV,CAAc,SAACC,UAAD,CAAe,CACtB,MAAO,qBAAC,GAAD,EAAK,GAAG,CAAEA,UAAV,CACK,SAAS,CAAE,MAAI,CAACnC,SADrB,CAEK,GAAG,CAAEmC,UAAU,CAACpC,GAFrB,CAGK,IAAI,CAAEoC,UAAU,CAACvC,IAHtB,CAIH,WAAW,CAAEmC,cAJV,EAAP,CAMf,CAPQ,CADG,CAXR,CAZJ,CADJ,CAwCH,C,qBA9HgCnE,S,EAgIrC;OAhIqBqC,O","sourcesContent":["import React, { Component } from 'react'\nimport { Link } from 'react-router-dom';\nimport axios from 'axios';\nimport \"../bugtrack/bugs.css\"\nimport jwt_decode from \"jwt-decode\";\nimport setAuthToken from \"../../utils/setAuthToken\";\nimport { setCurrentUser, logoutUser } from \"../../actions/authActions\";\nimport store from \"../../store\";\n\nif (localStorage.jwtToken) {\n    // Set auth token header auth\n    const token = localStorage.jwtToken;\n    setAuthToken(token);\n    // Decode token and get user info and exp\n    const decoded = jwt_decode(token);\n    // Set user and isAuthenticated\n    store.dispatch(setCurrentUser(decoded));\n  // Check for expired token\n    const currentTime = Date.now() / 1000; // to get in milliseconds\n    if (decoded.exp < currentTime) {\n      // Logout user\n      store.dispatch(logoutUser());\n      // Redirect to login\n      window.location.href = \"/login\";\n    }\n  }\n\nconst Bug = props => (\n        \n    <tr>\n        {/* <td className={props.bug.completed ? 'completed' : ''}>{props.projectName}</td> */}\n        {props.projectName}\n        <td className={props.bug.completed ? 'completed' : ''}>{props.bug.description}</td>\n        <td className={props.bug.completed ? 'completed' : ''}>\n            {new Intl.DateTimeFormat(\"en-GB\", {\n                year: \"numeric\",\n                month: \"long\",\n                day: \"2-digit\"\n            }).format(new Date(props.date))}\n        </td>\n        <td className={props.bug.completed ? 'completed' : ''}>{props.bug.members}</td>\n        <td className={props.bug.completed ? 'completed' : ''}>{props.bug.priority}</td>\n        \n        <td>\n            <Link to={\"/edit/\"+props.bug._id} className=\"btn btn-success\" >Edit </Link> <button className=\"btn btn-danger\" onClick={() => { props.deleteBug(props.bug._id) }}> Delete</button> \n        </td>\n    </tr>\n)\nexport default class BugList extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            bugs: [],\n            query: '',\n            projects: []\n        };\n        this.searchQuery = this.searchQuery.bind(this);\n        this.deleteBug = this.deleteBug.bind(this);\n    \n    }\n\n    \n    componentDidMount() {\n        axios.get('http://localhost:4000/bugs/')\n            .then(response => {\n                this.setState({\n                    bugs: response.data});\n            \n            }).then(axios.get('http://localhost:4000/projects')\n                .then(response => {\n                    this.setState({\n                        projects: response.data});\n                    console.log(\"Projects\", JSON.stringify(this.state.projects));\n                }))\n            .catch(function(error) {\n                console.log(error)\n            })\n    }\n\n\n    searchQuery(e) {\n        this.setState({\n            query: e.target.value\n            \n        })\n    }\n\n\n    deleteBug(id) {\n        axios.delete('http://localhost:4000/bugs/'+id) \n            .then(response => {console.log(response.data)});\n\n        this.setState({\n            bugs: this.state.bugs.filter(el => el._id !== id)\n        })\n    }\n\n    // bugList() {\n    //     return this.state.bugs.map((currentBug) =>{\n\n    //         return <Bug bug={currentBug}\n    //                     deleteBug={this.deleteBug}\n    //                     key={currentBug._id}\n    //                     date={currentBug.date.substring(0,10)} />;\n    //     });\n    // }\n    \n    render() {\n        console.log(\"Bugs projects \",this.state.projects);\n        console.log(\"Bugs component \" + JSON.stringify(this.state.bugs));\n\n        let findQuery = this.state.bugs.filter(\n            i => i.description.toLowerCase().indexOf(this.state.query.toLowerCase()) !== -1);\n        \n        \n        let newArr = [];\n\n        let getProjectName = this.state.projects.filter(i => {\n            this.state.bugs.filter(j => {\n                if(i._id === j.projects) {\n                    return <td>{i.projectName}</td>\n                }     \n            })\n        });\n\n        console.log(\"New arr\", newArr);\n\n        console.log(\"GetProject Name\", getProjectName);\n        console.log(\"Query: \" + this.state.query);\n        console.log(\"Date: \",this.state.projects.dateCreated);\n        \n        //console.log(\"Found query \" + JSON.stringify(findQuery));\n        \n        return (\n            <div className=\"container-fluid\">\n                <ol className=\"breadcrumb mb-3\">\n                    <li className=\"breadcrumb-item active\"><strong>Bugs list</strong></li>\n                </ol>\n                \n                <input\n                    className=\"form-control mr-sm-2\"\n                    onChange={this.searchQuery}\n                    type=\"text\"\n                    placeholder=\"Search descriptions...\"\n                />\n\n                <table className=\"table\">\n                        <thead>\n                            <tr>\n                                \n                                <th>Description</th>\n                                <th>Deadline</th>\n                                <th>Assignee</th>\n                                <th>Priority</th>\n                                <th>Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                    {findQuery.map((currentBug) =>{\n                            return <Bug bug={currentBug}\n                                        deleteBug={this.deleteBug}\n                                        key={currentBug._id}\n                                        date={currentBug.date} \n                                projectName={getProjectName}\n                                />\n            })}\n                \n                        </tbody>\n\n\n                    </table>\n            </div>\n        )\n    }\n}\n// "]},"metadata":{},"sourceType":"module"}